<!DOCTYPE html>
<!--
Prologue by HTML5 UP
html5up.net | @ajlkn
Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
Jekyll integration by Chris Bobbe | chrisbobbe.github.io
-->
<html><head><!-- Robots -->
  <meta name="robots" content="index, follow" /><link rel="canonical" href="https://me.k3k.dev/2023/01/29/get-a-free-kubernetes-cluster-with-oracle-cloud-infrastructure.html" /><!-- Title, description, author --><title>Get a FREE Kubernetes cluster with Oracle Cloud Infrastructure | K3K&#39;s Hideout</title>
  <meta name="description" content="A random Vietnamese catto&#39;s attempt at learning how to make a blog using out-of-the-box solutions." />
  <meta name="author" content="Kha Trần" />
  
  <!-- Open Graph -->
  <meta property="og:title" content="Get a FREE Kubernetes cluster with Oracle Cloud Infrastructure | K3K&#39;s Hideout" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://me.k3k.dev/assets/images/avatar.png" />
  <meta property="og:url" content="https://me.k3k.dev/2023/01/29/get-a-free-kubernetes-cluster-with-oracle-cloud-infrastructure.html" />
  <meta property="og:site_name" content="K3K&#39;s Hideout" />
  <meta property="og:description" content="A random Vietnamese catto&#39;s attempt at learning how to make a blog using out-of-the-box solutions." />
  
  <!-- Styles -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js" defer></script><![endif]-->
  <link rel="stylesheet" href="/assets/css/main.css" />
  <!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie8.css" /><![endif]-->
  <!--[if lte IE 9]><link rel="stylesheet" href="/assets/css/ie9.css" /><![endif]-->
  <link defer rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css">
  <link rel="preload" href="https://gamer2810.github.io/steam-miniprofile/" as="document">

  <link defer rel="stylesheet" href="https://steamcommunity-a.akamaihd.net/public/shared/css/shared_global.css?v=8auqH9wO7vE-&l=english">
  <link defer rel="stylesheet" href="chrome://global/skin/media/videocontrols.css ">
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

  <!-- Scripts -->
  
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script
			  src="https://code.jquery.com/jquery-migrate-3.3.1.min.js"
			  integrity="sha256-APllMc0V4lf/Rb5Cz4idWUCYlBDG3b0EcN1Ushd3hpE="
        crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?skin=desert"></script>
        
  <script src="/assets/js/jquery.scrolly.min.js" defer></script>
  <script src="/assets/js/jquery.scrollzer.min.js" defer></script>
  <script src="/assets/js/skel.min.js" defer></script>
  <script src="/assets/js/util.js" defer></script>
  <script src="/assets/js/particles.min.js"></script>
  <!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js" defer></script><![endif]-->
  <script src="/assets/js/main.js" defer></script>
  <link rel="shortcut icon" type="image/png" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>

  <link rel="stylesheet" href="/assets/css/syntax_github.css" defer>

  <!-- <link rel="stylesheet" href="https://steamcommunity-a.akamaihd.net/public/shared/css/shared_global.css?v=8auqH9wO7vE-&l=english" defer> -->
  <!-- <link rel="stylesheet" href="chrome://global/skin/media/videocontrols.css "> -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/noframework.waypoints.min.js"></script>
  
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>


</head><body><!-- Header -->
<div id="header">
  <div class="top"><!-- Logo -->
<div>
  <h3 id="nameplate" style="text-align: left; padding-left:0.5em; color:aliceblue">About Me</h3>
  <a class="steam-cover" href="https://steamcommunity.com/id/k3k2810" target="_blank" rel="noopener noreferrer">
    <div id="logo">
      <div class="aspectwrapper">
        <div class="miniprofile_container">
          <!-- Background -->
          <div class="miniprofile_nameplatecontainer" style="height: 350px">
            <video class="miniprofile_nameplate" playsinline autoplay muted loop>
              <source
                src="https://cdn.akamai.steamstatic.com/steamcommunity/public/images/items/1263950/02b159162206fc652f28707be593c4a01988a5c2.webm"
                type="video/webm">
            </video>
          </div>
          <div class="miniprofile_playersection text_shadow">
            <!-- Player avatar/name stuff -->
            <div class="playersection_avatar_frame">
              <img
                src="https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/items/1069740/85030942387d8c7803922f84c31e82bc42728279.png">
            </div>
            <div class="playersection_avatar border_color_online">
              <img src="https://avatars.cloudflare.steamstatic.com/c5fd8fcc8cb58fa8f71854aba3da644fded00230_medium.jpg"
                srcset="https://avatars.cloudflare.steamstatic.com/c5fd8fcc8cb58fa8f71854aba3da644fded00230_medium.jpg 1x, https://avatars.cloudflare.steamstatic.com/c5fd8fcc8cb58fa8f71854aba3da644fded00230_full.jpg 2x">
            </div>
            <div class="player_content">
              <span class="persona in-game">Kha Trần</span>
            </div>
          </div>
          <div class="miniprofile_gamesection miniprofile_backdropblur miniprofile_backdrop" style="height: 100px">
            <img class="game_logo" src="/assets/images/momo_icon.png" style="top: 52px;">
            <div class="miniprofile_game_details">
              <span class="game_state">In-Game</span>
              <span class="miniprofile_game_name">MoMo</span>
              <span class="rich_presence">Delivering solutions with</span>
              <span class="rich_presence">Kotlin and Vert.x</span>
            </div>
          </div>
          <div class="miniprofile_featuredcontainer" style="margin-top: 8px;">
            <img src="https://community.akamai.steamstatic.com/public/images/badges/02_years/steamyears3_54.png"
              class="badge_icon">
            <div class="description">
              <div class="name">Years of Professional Service</div>
              <div class="xp">mid 2019 - now</div>
            </div>
          </div>
          <div class="miniprofile_featuredcontainer">
            <div class="friendPlayerLevel lvl_5000"><span class="friendPlayerLevelNum">2</span></div>
            <div class="description">
              <div class="name">Languages Learnt</div>
              <div class="xp">Vietnamese, English</div>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>
</a>
</div><div class="bottom"><!-- Social Icons -->
<ul class="icons"><li><a href="https://www.facebook.com/minh.kha.1441/" class="icon-b fa-facebook-f"><span class="label">Facebook</span></a></li><li><a href="https://www.linkedin.com/in/kha-3k-tran/" class="icon-b fa-linkedin-in"><span class="label">LinkedIn</span></a></li><li><a href="https://github.com/gamer2810/" class="icon-b fa-github"><span class="label">GitHub</span></a></li><li><a href="mailto:khabaka321998@gmail.com" class="icon fa-envelope"><span class="label">Email</span></a></li></ul>
</div><!-- Nav -->
<nav id="nav">
  <ul><li>
      <h3 style="text-align: center">Directories</h3>
    </li><li>
      <a href="/" id="home-link">
        <span class="icon fa-home">Home</span>
      </a>
    </li><li>
      <a href="/blog" id="tech-posts-link">
        <span class="icon fa-pencil-alt">Tech Posts</span>
      </a>
    </li><li>
      <a href="/reading" id="test-ground-link">
        <span class="icon fa-book">Test Ground</span>
      </a>
    </li><li>
      <a href="/diaryentry" id="miscellaneous-link">
        <span class="icon fa-beer">Miscellaneous</span>
      </a>
    </li><li>
      <a href="/codex" id="all-posts-link">
        <span class="icon fa-book">All Posts</span>
      </a>
    </li></ul>
</nav>
</div>
</div>
<!-- Main -->
<div id="main">
	<!-- Post -->
	<article class="shade-two">
		<div class="container">
			<header>
				<h1>Get a FREE Kubernetes cluster with Oracle Cloud Infrastructure</h1>
				<p>K3K, 29 January 2023</p>
			</header>
			
			<div class="tableofcontent">
				<p style ="color:#da4a69">Table of Contents</p>
				<ol>
  <li><a href="#free-k8s-cluster">Free K8S cluster</a></li>
  <li><a href="#warning">Warning</a></li>
  <li><a href="#steps">Steps</a></li>
  <li><a href="#0-get-basic-knowledge">0/ Get basic knowledge</a>
    <ol>
      <li><a href="#1-get-the-cluster-online">1/ Get the cluster online</a></li>
    </ol>
  </li>
  <li><a href="#2-connect-to-your-cluster">2/ Connect to your cluster</a></li>
  <li><a href="#3-setup-the-essentials">3/ Setup the essentials</a>
    <ol>
      <li><a href="#calico">Calico</a></li>
      <li><a href="#metric-server">Metric server</a></li>
    </ol>
  </li>
  <li><a href="#4-have-fun">4/ Have fun</a></li>
</ol>
			</div>
			<br><h1 id="free-k8s-cluster">Free K8S cluster</h1>

<h1 id="warning">Warning</h1>

<p>1/ I will not take responsibility if you are charged with OCI usage from following this guide. There are many configs that I can’t possibly cover in this post that will incur usage cost.</p>

<p>2/ As the computing shape we use runs on the ARM64 architecture. Check the Docker images you will run if they have an ARM64 release.</p>

<h1 id="steps">Steps</h1>

<h1 id="0-get-basic-knowledge">0/ Get basic knowledge</h1>

<p>You should at least know about Terraform, Docker, Kubernetes to follow this guide.</p>

<h2 id="1-get-the-cluster-online">1/ Get the cluster online</h2>

<p>Pretty much following this quickstart guide</p>

<p><a href="https://github.com/oracle-terraform-modules/terraform-oci-oke/blob/main/docs/quickstart.adoc">terraform-oci-oke/quickstart.adoc at main · oracle-terraform-modules/terraform-oci-oke</a></p>

<p><strong>Important:</strong> To keep the cluster running on Always Free resource, you have to change these settings:</p>

<ul>
  <li>Turn off bastion host and operator host as their setup script does not work well with ARM computing shapes (VM).</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create_bastion_host <span class="o">=</span> <span class="nb">false
</span>create_operator                    <span class="o">=</span> <span class="nb">false</span>
</code></pre></div></div>

<ul>
  <li>Allow public access to K8S API. As we disabled operator host, we will install and use kubectl on our local machine to control the cluster.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>control_plane_type           <span class="o">=</span> <span class="s2">"public"</span>
</code></pre></div></div>

<ul>
  <li>Config your node pool to use the VM.Standard.A1.Flex shape.</li>
</ul>

<p>Oracle provides 4 CPU - 24 GB RAM of this shape for free every month. You can split these however you like but know that each node will have 50GB of boot volume attached and you only have 200GB for free. For that reason I will config mine with 2 nodes, each with 2 CPU and 12 GB of RAM.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>np1 <span class="o">=</span> <span class="o">{</span>
   shape            <span class="o">=</span> <span class="s2">"VM.Standard.A1.Flex"</span>,
   ocpus            <span class="o">=</span> 2,
   memory           <span class="o">=</span> 12,
   node_pool_size   <span class="o">=</span> 2,
   boot_volume_size <span class="o">=</span> 50,
   placement_ads    <span class="o">=</span> <span class="o">[</span>1]
  <span class="o">}</span>
</code></pre></div></div>

<p>Don’t bother with the calico, metric server, etc. settings because they are configured to be installed from your operator host. Since we don’t have one, they won’t be install on your cluster.</p>

<p>It is <strong>highly encouraged</strong> that you read about what the Terraform script setups as configs may incur cost:</p>

<p><a href="https://github.com/oracle-terraform-modules/terraform-oci-oke/blob/main/docs/topology.adoc">terraform-oci-oke/topology.adoc at main · oracle-terraform-modules/terraform-oci-oke</a></p>

<p><a href="https://github.com/oracle-terraform-modules/terraform-oci-oke/blob/main/docs/instructions.adoc">terraform-oci-oke/instructions.adoc at main · oracle-terraform-modules/terraform-oci-oke</a></p>

<h1 id="2-connect-to-your-cluster">2/ Connect to your cluster</h1>

<p>Install kubectl on your local machine</p>

<p>Find your cluster in the OCI console at: <a href="https://cloud.oracle.com/containers/clusters?region=ap-singapore-1">https://cloud.oracle.com/containers/clusters</a></p>

<p>Click on access cluster</p>

<p>Copy and run the kubeconfig command from the popup, it should look like:</p>

<blockquote>
  <p>To access the kubeconfig for your cluster via the VCN-Native public endpoint, copy the following command:</p>
</blockquote>

<p>oci ce cluster create-kubeconfig –cluster-id ocid1.cluster.xxx –file $HOME/.kube/config –region yyyy –token-version 2.0.0 –kube-endpoint PUBLIC_ENDPOINT</p>

<h1 id="3-setup-the-essentials">3/ Setup the essentials</h1>

<h2 id="calico">Calico</h2>

<p>The cluster comes with Flannel as its CNI. I find it quite buggy and not being actively maintained. We can switch to Calico with a few commands from this handy guide:</p>

<p><a href="https://projectcalico.docs.tigera.io/getting-started/kubernetes/flannel/migration-from-flannel">Migrate a Kubernetes cluster from flannel/Canal to Calico</a></p>

<h2 id="metric-server">Metric server</h2>

<p>Installing this is required to run the <code class="language-plaintext highlighter-rouge">top</code> commands.</p>

<p>Just run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl apply <span class="nt">-f</span> https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
</code></pre></div></div>

<h1 id="4-have-fun">4/ Have fun</h1>

<p>Now you have a up-and-running K8S cluster that you can experiment with for free.</p>

			<div id="disqus_thread"></div>
			<script defer>
				var disqusload = false; //initiate as false
				var waypoint = new Waypoint({
					element: document.getElementById('disqus_thread'),
					handler: function () { // DON'T EDIT BELOW THIS LINE
						if (disqusload) return;
						var d = document, s = d.createElement('script');
						s.src = 'https://gamer2810.disqus.com/embed.js';
						s.setAttribute('data-timestamp', +new Date());
						(d.head || d.body).appendChild(s);
						disqusload = true;
					},
					offset: 'bottom-in-view',
				});
			</script>
			
		</div>


	</article>

	<script defer>
		var anchorForId = function (id) {
			var anchor = document.createElement("a");
			anchor.className = "header-link";
			anchor.href = "#" + id;
			anchor.innerHTML = '<span> </span><i class="fa fa-link" style="font-size: 60%;"></i>';
			return anchor;
		};

		var linkifyAnchors = function (level, containingElement) {
			var headers = containingElement.getElementsByTagName("h" + level);
			var toc = document.getElementById("toc");

			for (var h = 0; h < headers.length; h++) {
				var header = headers[h];
				var id =
					header.innerText.replace(/\s/g, "-").replace(/[^a-zA-Z0-9-]/g, "").toLowerCase();
				header.setAttribute("id", id);

				header.appendChild(anchorForId(id));

				let li = document.createElement("li");
				let a = document.createElement("a");
				a.setAttribute('href', header.id);
				a.setAttribute('innerText', header.innerText);
				li.appendChild(a);

				if (toc != undefined) {
					toc.appendChild(li);
				}
			}
		};

		document.onreadystatechange = function () {
			if (this.readyState === "complete") {
				var contentBlock = document.getElementById("main");
				if (!contentBlock) {
					return;
				}
				for (var level = 2; level <= 6; level++) {
					linkifyAnchors(level, contentBlock);
				}
			}
		};
	</script>
</div><!-- Footer -->
<div id="footer">
  
  <!-- Copyright -->
  <ul class="copyright">
    <li>Providing shelter and antidepressants since 2020.</li>
    
      <li>&copy;K3K's Hideout. All rights reserved.</li>
    
  </ul>
  
</div></body>

</html>
